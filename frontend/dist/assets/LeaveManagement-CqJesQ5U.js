import{r as u,c as b,o as M,b as a,p as e,t as n,x as _,y as N,A as F,z as k,C as B,F as E,D as $,g as f,f as l}from"./vendor-CFHPe_rb.js";import{_ as U}from"./index-CUA5mSp8.js";const V={class:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8 px-4 sm:px-6 lg:px-8"},T={class:"max-w-7xl mx-auto"},z={class:"text-center mb-8"},P={class:"text-gray-600 text-lg"},R={class:"bg-white rounded-xl shadow-sm p-6 mb-6"},H={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},I={class:"flex flex-col sm:flex-row gap-4 w-full lg:w-auto flex-1"},Y={class:"relative flex-1"},q=["disabled"],O={key:0,class:"bg-white rounded-xl shadow-sm p-12 text-center"},G={key:1,class:"bg-white rounded-xl shadow-sm overflow-hidden"},J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},Q={class:"bg-white divide-y divide-gray-200"},W={class:"px-6 py-4 whitespace-nowrap"},X={class:"text-sm font-medium text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap"},ee={class:"text-sm text-gray-600"},te={class:"px-6 py-4 whitespace-nowrap"},se={class:"text-sm text-gray-600"},oe={class:"px-6 py-4 whitespace-nowrap"},re={class:"text-sm text-gray-600"},ae={class:"px-6 py-4 whitespace-nowrap"},ne={class:"text-sm text-gray-600"},le={class:"px-6 py-4 whitespace-nowrap"},ie={class:"text-sm font-medium text-gray-900"},de={class:"px-6 py-4"},ce=["title"],pe={class:"px-6 py-4 whitespace-nowrap"},ue={class:"px-6 py-4 whitespace-nowrap text-sm"},ge={key:0,class:"flex gap-2"},xe=["onClick","disabled"],me=["onClick","disabled"],fe={key:1,class:"text-gray-400 italic"},he={key:0,class:"text-center py-12"},ye={__name:"LeaveManagement",setup(ve){const h=u([]),i=u(!1),d=u(!1),m=u(""),g=u("all"),A=b(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long"})),x=async()=>{i.value=!0;try{const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),1),o=new Date(t.getFullYear(),t.getMonth()+1,0),r=await f.get("/api/admin/leaves/current-month",{params:{start_date:s.toISOString().split("T")[0],end_date:o.toISOString().split("T")[0]}});h.value=Array.isArray(r.data)?r.data:r.data.data||[]}catch(t){console.error("âŒ Error fetching leave records:",t),alert("Failed to fetch leaves. Please try again.")}finally{i.value=!1}},L=async t=>{if(confirm("Are you sure you want to approve this leave request?")){d.value=!0;try{console.log(`âœ… Approving leave ID: ${t}`),await f.post(`/api/manager/leaves/${t}/approve`),alert("Leave approved successfully!"),await x()}catch(s){console.error("âŒ Error approving leave:",s),alert("Failed to approve leave. Please try again.")}finally{d.value=!1}}},C=async t=>{if(confirm("Are you sure you want to reject this leave request?")){d.value=!0;try{await f.post(`/api/manager/leaves/${t}/reject`),alert("Leave rejected successfully!"),await x()}catch(s){console.error("âŒ Error rejecting leave:",s),alert("Failed to reject leave. Please try again.")}finally{d.value=!1}}},y=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",D=t=>t?t.charAt(0).toUpperCase()+t.slice(1):"N/A",S=t=>t?t.charAt(0).toUpperCase()+t.slice(1):"N/A",v=t=>{var s,o,r,c,p;return(o=(s=t.employee)==null?void 0:s.user)!=null&&o.name?t.employee.user.name:(r=t.employee)!=null&&r.full_name&&t.employee.full_name!=="N/A"?t.employee.full_name:(p=(c=t.employee)==null?void 0:c.user)!=null&&p.first_name?`${t.employee.user.first_name} ${t.employee.user.last_name||""}`.trim():"N/A"},w=b(()=>{const t=h.value.filter(s=>{var p;const r=v(s).toLowerCase().includes(m.value.toLowerCase()),c=g.value==="all"||((p=s.status)==null?void 0:p.toLowerCase())===g.value;return r&&c});return console.log("ðŸ” Filtered leaves count:",t.length),t}),j=t=>{switch(t==null?void 0:t.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return M(()=>{x()}),(t,s)=>(l(),a("div",V,[e("div",T,[e("div",z,[s[2]||(s[2]=e("h1",{class:"text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2"}," Leave Management ",-1)),e("p",P," Showing all approved and pending leaves for "+n(A.value),1)]),e("div",R,[e("div",H,[e("div",I,[e("div",Y,[s[3]||(s[3]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>m.value=o),type:"text",placeholder:"Search by employee name...",class:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"},null,512),[[N,m.value]])]),_(e("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>g.value=o),class:"block w-full sm:w-48 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 bg-white"},[...s[4]||(s[4]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"rejected"},"Rejected",-1)])],512),[[F,g.value]])]),e("button",{onClick:x,disabled:i.value,class:"inline-flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-medium rounded-lg hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md"},[(l(),a("svg",{class:k(["h-5 w-5",{"animate-spin":i.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[5]||(s[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),s[6]||(s[6]=e("span",null,"Refresh",-1))],8,q)])]),i.value?(l(),a("div",O,[...s[7]||(s[7]=[e("div",{class:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent mb-4"},null,-1),e("p",{class:"text-gray-600 text-lg"},"Loading leave records...",-1)])])):(l(),a("div",G,[e("div",J,[e("table",K,[s[10]||(s[10]=e("thead",{class:"bg-gradient-to-r from-indigo-600 to-purple-600"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Employee "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Department "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Leave Type "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Start Date "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," End Date "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Days "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Reason "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Q,[(l(!0),a(E,null,$(w.value,o=>{var r;return l(),a("tr",{key:o.id,class:"hover:bg-indigo-50 transition-colors duration-150"},[e("td",W,[e("div",X,n(v(o)),1)]),e("td",Z,[e("div",ee,n(((r=o.employee)==null?void 0:r.department)||"N/A"),1)]),e("td",te,[e("div",se,n(D(o.type)),1)]),e("td",oe,[e("div",re,n(y(o.start_date)),1)]),e("td",ae,[e("div",ne,n(y(o.end_date)),1)]),e("td",le,[e("div",ie,n(o.total_days),1)]),e("td",de,[e("div",{class:"text-sm text-gray-600 max-w-xs truncate",title:o.reason||"N/A"},n(o.reason||"N/A"),9,ce)]),e("td",pe,[e("span",{class:k([j(o.status),"inline-flex px-3 py-1 text-xs font-semibold rounded-full"])},n(S(o.status)),3)]),e("td",ue,[o.status==="pending"?(l(),a("div",ge,[e("button",{onClick:c=>L(o.id),disabled:d.value,class:"inline-flex items-center gap-1 px-3 py-1.5 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200"},[...s[8]||(s[8]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("span",null,"Approve",-1)])],8,xe),e("button",{onClick:c=>C(o.id),disabled:d.value,class:"inline-flex items-center gap-1 px-3 py-1.5 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200"},[...s[9]||(s[9]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),e("span",null,"Reject",-1)])],8,me)])):(l(),a("span",fe,"No actions"))])])}),128))])])]),w.value.length===0&&!i.value?(l(),a("div",he,[...s[11]||(s[11]=[e("svg",{class:"mx-auto h-16 w-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-gray-600 text-lg"},"No leave records found for the current month.",-1)])])):B("",!0)]))])]))}},_e=U(ye,[["__scopeId","data-v-542a71c2"]]);export{_e as default};
