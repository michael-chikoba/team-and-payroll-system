import{_ as D,u as k}from"./index-Djdf6BKf.js";import{b as l,p as s,s as u,t as a,F as v,C as _,a as L,w,e as C,q as f,g as N,f as o,z as A}from"./vendor-COruVTVJ.js";const B={name:"EmployeeDashboard",setup(){return{authStore:k()}},data(){return{pageName:"Employee Dashboard",stats:{},loading:!1,error:null,retryCount:0}},mounted(){this.initializeComponent()},methods:{initializeComponent(){if(!this.authStore.isAuthenticated){this.error="Please log in to access the dashboard.",this.$router.push({name:"login"});return}this.fetchDashboardData(),this.refreshInterval=setInterval(()=>{this.fetchDashboardData(!0)},3e5)},async fetchDashboardData(n=!1){n||(this.loading=!0),this.error=null;try{const e=await N.get("/api/dashboard");if(e.data.role==="employee"&&e.data.stats){const i=this.stats.leave_balances||{};this.stats=e.data.stats,!n&&this.hasBalancesChanged(i,this.stats.leave_balances)&&this.showBalanceUpdateNotification()}else e.data.role!=="employee"&&(this.error="This dashboard is for employees only.")}catch(e){console.error("Dashboard fetch error:",e),n||this.handleApiError(e)}finally{n||(this.loading=!1)}},hasBalancesChanged(n,e){if(!n||Object.keys(n).length===0)return!1;for(const i in e)if(n[i]!==e[i])return!0;return!1},showBalanceUpdateNotification(){this.$notify&&this.$notify({type:"info",title:"Leave Balances Updated",text:"Your leave balances have been updated based on new company policies.",duration:5e3})},getTotalLeaveBalance(){return this.stats.leave_balances?Object.values(this.stats.leave_balances).reduce((n,e)=>n+e,0):0},formatLeaveType(n){return n?{annual:"Annual Leave",sick:"Sick Leave",maternity:"Maternity Leave",paternity:"Paternity Leave",bereavement:"Bereavement Leave",unpaid:"Unpaid Leave"}[n.toLowerCase()]||n.split("_").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" "):"N/A"},formatDate(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}},beforeUnmount(){this.refreshInterval&&clearInterval(this.refreshInterval)}},S={class:"dashboard-view"},T={class:"dashboard-header"},E={class:"welcome-title"},P={key:0,class:"summary-cards"},U={class:"card"},x={class:"value"},I={class:"card"},F={class:"value"},V={class:"card"},j={class:"value"},z={class:"card"},H={class:"value"},M={key:1,class:"info-section"},O={class:"info-card"},R={class:"attendance-grid"},q={class:"attendance-item"},Y={class:"value present"},W={class:"attendance-item"},G={class:"value absent"},J={class:"attendance-item"},K={class:"value late"},Q={class:"attendance-item"},X={class:"value"},Z={class:"info-card"},$={class:"leave-balances"},ss={class:"leave-type"},es={class:"leave-balance"},ts={key:0,class:"empty-state"},as={key:2,class:"records-section"},ns={class:"section-header"},ls={key:0,class:"records-table"},os={key:1,class:"empty-state"},rs={key:2,class:"payslip-info"},is={class:"payslip-detail"},ds={class:"value"},us={class:"payslip-detail"},cs={class:"value"},ps={class:"payslip-detail"},hs={class:"value"},ys={key:3,class:"empty-state"},ms={key:3,class:"loading"},vs={key:4,class:"error-message"};function _s(n,e,i,b,t,d){var c,p,h,y;const g=C("router-link");return o(),l("div",S,[s("header",T,[s("h1",E,"Welcome back, "+a(((c=b.authStore.user)==null?void 0:c.name)||"Employee")+"!",1),e[1]||(e[1]=s("p",{class:"subtitle"},"Here's what's happening with your payroll and records.",-1))]),t.loading?u("",!0):(o(),l("div",P,[s("div",U,[e[2]||(e[2]=s("div",{class:"card-icon"},"ðŸ“…",-1)),e[3]||(e[3]=s("h3",null,"Present Days",-1)),s("p",x,a(((p=t.stats.attendance_summary)==null?void 0:p.present_days)||0),1)]),s("div",I,[e[4]||(e[4]=s("div",{class:"card-icon"},"â°",-1)),e[5]||(e[5]=s("h3",null,"Total Hours",-1)),s("p",F,a(((h=t.stats.attendance_summary)==null?void 0:h.total_hours)||0),1)]),s("div",V,[e[6]||(e[6]=s("div",{class:"card-icon"},"ðŸŒ´",-1)),e[7]||(e[7]=s("h3",null,"Leave Balance",-1)),s("p",j,a(d.getTotalLeaveBalance()),1)]),s("div",z,[e[8]||(e[8]=s("div",{class:"card-icon"},"ðŸ’¼",-1)),e[9]||(e[9]=s("h3",null,"Overtime Hours",-1)),s("p",H,a(((y=t.stats.attendance_summary)==null?void 0:y.overtime_hours)||0),1)])])),!t.loading&&t.stats.attendance_summary?(o(),l("div",M,[s("div",O,[e[14]||(e[14]=s("h3",null,"This Month's Attendance",-1)),s("div",R,[s("div",q,[e[10]||(e[10]=s("span",{class:"label"},"Present:",-1)),s("span",Y,a(t.stats.attendance_summary.present_days||0)+" days",1)]),s("div",W,[e[11]||(e[11]=s("span",{class:"label"},"Absent:",-1)),s("span",G,a(t.stats.attendance_summary.absent_days||0)+" days",1)]),s("div",J,[e[12]||(e[12]=s("span",{class:"label"},"Late:",-1)),s("span",K,a(t.stats.attendance_summary.late_days||0)+" days",1)]),s("div",Q,[e[13]||(e[13]=s("span",{class:"label"},"Total Hours:",-1)),s("span",X,a(t.stats.attendance_summary.total_hours||0)+" hrs",1)])])]),s("div",Z,[s("h3",null,"Leave Balances ("+a(new Date().getFullYear())+")",1),s("div",$,[(o(!0),l(v,null,_(t.stats.leave_balances,(r,m)=>(o(),l("div",{key:m,class:"leave-item"},[s("span",ss,a(d.formatLeaveType(m)),1),s("span",es,a(r)+" days",1)]))),128)),Object.keys(t.stats.leave_balances||{}).length===0?(o(),l("div",ts,[...e[15]||(e[15]=[s("p",null,"No leave balances available",-1)])])):u("",!0)])])])):u("",!0),t.loading?u("",!0):(o(),l("div",as,[s("div",ns,[e[17]||(e[17]=s("h3",null,"Recent Leave Requests",-1)),L(g,{to:"/employee/leaves",class:"view-all"},{default:w(()=>[...e[16]||(e[16]=[f("View All â†’",-1)])]),_:1})]),t.stats.recent_leaves&&t.stats.recent_leaves.length>0?(o(),l("table",ls,[e[18]||(e[18]=s("thead",null,[s("tr",null,[s("th",null,"Type"),s("th",null,"Start Date"),s("th",null,"End Date"),s("th",null,"Days"),s("th",null,"Status"),s("th",null,"Reason")])],-1)),s("tbody",null,[(o(!0),l(v,null,_(t.stats.recent_leaves,r=>(o(),l("tr",{key:r.id},[s("td",null,a(d.formatLeaveType(r.type)),1),s("td",null,a(d.formatDate(r.start_date)),1),s("td",null,a(d.formatDate(r.end_date)),1),s("td",null,a(r.number_of_days||0),1),s("td",null,[s("span",{class:A(["status",r.status.toLowerCase()])},a(r.status),3)]),s("td",null,a(r.reason||"N/A"),1)]))),128))])])):(o(),l("div",os,[...e[19]||(e[19]=[s("p",null,"No recent leave requests.",-1)])])),e[24]||(e[24]=s("div",{class:"section-header",style:{"margin-top":"2rem"}},[s("h3",null,"Next Payslip")],-1)),t.stats.upcoming_payslip?(o(),l("div",rs,[s("div",is,[e[20]||(e[20]=s("span",{class:"label"},"Period:",-1)),s("span",ds,a(t.stats.upcoming_payslip.payroll_period),1)]),s("div",us,[e[21]||(e[21]=s("span",{class:"label"},"Processing Date:",-1)),s("span",cs,a(d.formatDate(t.stats.upcoming_payslip.processing_date)),1)]),s("div",ps,[e[22]||(e[22]=s("span",{class:"label"},"Estimated Days:",-1)),s("span",hs,a(t.stats.upcoming_payslip.estimated_days)+" days",1)])])):(o(),l("div",ys,[...e[23]||(e[23]=[s("p",null,"No upcoming payslip information available.",-1)])]))])),t.loading?(o(),l("div",ms,[...e[25]||(e[25]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading dashboard...",-1)])])):u("",!0),t.error?(o(),l("div",vs,[f(a(t.error)+" ",1),s("button",{onClick:e[0]||(e[0]=(...r)=>n.retryFetch&&n.retryFetch(...r)),class:"btn-primary"},"Retry")])):u("",!0)])}const gs=D(B,[["render",_s],["__scopeId","data-v-060e0f1a"]]);export{gs as default};
