import{_,u as y}from"./index-Djdf6BKf.js";import{b as l,p as e,q as f,t as r,s as h,F as v,C as b,g as E,f as d}from"./vendor-COruVTVJ.js";const w={name:"EmployeeList",setup(){return{authStore:y()}},data(){return{employees:[],loading:!1,error:null,retryCount:0,expandedEmployees:new Set}},mounted(){this.initializeComponent()},methods:{initializeComponent(){if(!this.authStore.isAuthenticated){this.error="Please log in to access employee management.";return}if(!this.authStore.isManager){this.error="You do not have permission to access this page.";return}this.fetchEmployees()},async fetchEmployees(t=!1){var s;this.loading=!0,this.error=null;try{const o=await E.get("/api/manager/employees",{params:{manager_id:(s=this.authStore.user)==null?void 0:s.id}});this.employees=o.data.data||o.data}catch(o){console.error("Fetch error:",o),console.error("Error response:",o.response),console.error("Full error:",o.toJSON?o.toJSON():o),this.handleApiError(o)}finally{this.loading=!1}},retryFetch(){this.retryCount++,this.retryCount<=3?this.fetchEmployees(!0):this.error="Max retries exceeded. Check your network or server."},handleApiError(t){var o,m,i,n;let s="An unexpected error occurred. (Likely CORS - check console)";t.code==="ERR_NETWORK"||t.message.includes("Network Error")?s="Network/CORS error: Ensure backend allows requests from localhost:3000":((o=t.response)==null?void 0:o.status)===401?(s="Your session has expired. Please log in again.",this.authStore.clearAuth(),this.$router.push({name:"login"})):((m=t.response)==null?void 0:m.status)===403?s="You do not have permission to perform this action.":s=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||s,this.error=s},toggleExpanded(t){this.expandedEmployees.has(t)?this.expandedEmployees.delete(t):this.expandedEmployees.add(t)},viewEmployee(t){this.$router.push({name:"employee-details",params:{id:t.id}})},getInitials(t){return t?t.split(" ").map(s=>s[0]).join("").toUpperCase().substring(0,2):"??"},formatNumber(t){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0)},formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"},formatEmploymentType(t){return{full_time:"Full Time",part_time:"Part Time",contract:"Contract"}[t]||t}}},k={class:"employee-management"},x={key:0,class:"error-message"},C={key:1,class:"error-message"},N={key:2,class:"loading"},S={key:3,class:"error-message"},A={key:4,class:"employees-grid"},D={class:"employee-header"},F={class:"employee-avatar"},R={class:"employee-info"},L={class:"employee-id"},T={class:"employee-details"},M={class:"detail-row"},P={class:"detail-row"},O={class:"detail-row"},V={class:"detail-row"},Y={class:"detail-row"},B={class:"detail-row"},U={class:"badge"},q={key:0,class:"expanded-details"},z={class:"detail-row"},H={class:"detail-row"},I={class:"detail-row"},J={class:"detail-row"},K={class:"badge rating-badge"},j={class:"detail-row"},W={class:"detail-row"},G={class:"employee-actions"},Q=["onClick"],X=["onClick"],Z={key:0,class:"empty-state"};function $(t,s,o,m,i,n){return d(),l("div",k,[s[15]||(s[15]=e("div",{class:"page-header"},[e("h1",null,"My Team - Employee Management")],-1)),m.authStore.isAuthenticated?m.authStore.isManager?i.loading?(d(),l("div",N,[...s[1]||(s[1]=[e("div",{class:"spinner"},null,-1),e("p",null,"Loading team members...",-1)])])):i.error?(d(),l("div",S,[f(r(i.error)+" ",1),e("button",{onClick:s[0]||(s[0]=(...a)=>n.retryFetch&&n.retryFetch(...a)),class:"btn-primary",style:{"margin-top":"1rem"}},"Retry")])):(d(),l("div",A,[(d(!0),l(v,null,b(i.employees,a=>{var u,p,c;return d(),l("div",{key:a.id,class:"employee-card"},[e("div",D,[e("div",F,r(n.getInitials(a.full_name||((u=a.user)==null?void 0:u.name))),1),e("div",R,[e("h3",null,r(a.full_name||((p=a.user)==null?void 0:p.name)),1),e("p",L,r(a.employee_id),1)])]),e("div",T,[e("div",M,[s[2]||(s[2]=e("span",{class:"label"},"ðŸ“§ Email:",-1)),e("span",null,r(a.email||((c=a.user)==null?void 0:c.email)),1)]),e("div",P,[s[3]||(s[3]=e("span",{class:"label"},"ðŸ’¼ Position:",-1)),e("span",null,r(a.position),1)]),e("div",O,[s[4]||(s[4]=e("span",{class:"label"},"ðŸ¢ Department:",-1)),e("span",null,r(a.department),1)]),e("div",V,[s[5]||(s[5]=e("span",{class:"label"},"ðŸ’° Salary:",-1)),e("span",null,"K"+r(n.formatNumber(a.base_salary)),1)]),e("div",Y,[s[6]||(s[6]=e("span",{class:"label"},"ðŸ“… Hire Date:",-1)),e("span",null,r(n.formatDate(a.hire_date)),1)]),e("div",B,[s[7]||(s[7]=e("span",{class:"label"},"ðŸ“‹ Type:",-1)),e("span",U,r(n.formatEmploymentType(a.employment_type)),1)])]),i.expandedEmployees.has(a.id)?(d(),l("div",q,[e("div",z,[s[8]||(s[8]=e("span",{class:"label"},"ðŸ“ž Phone:",-1)),e("span",null,r(a.phone||"N/A"),1)]),e("div",H,[s[9]||(s[9]=e("span",{class:"label"},"ðŸ  Address:",-1)),e("span",null,r(a.address||"N/A"),1)]),e("div",I,[s[10]||(s[10]=e("span",{class:"label"},"ðŸš¨ Emergency Contact:",-1)),e("span",null,r(a.emergency_contact||"N/A"),1)]),e("div",J,[s[11]||(s[11]=e("span",{class:"label"},"â­ Performance Rating:",-1)),e("span",K,r(a.performance_rating||"N/A"),1)]),e("div",j,[s[12]||(s[12]=e("span",{class:"label"},"ðŸ“Š Last Review Date:",-1)),e("span",null,r(n.formatDate(a.last_review_date)),1)]),e("div",W,[s[13]||(s[13]=e("span",{class:"label"},"ðŸ“ Notes:",-1)),e("span",null,r(a.notes||"No notes available"),1)])])):h("",!0),e("div",G,[e("button",{onClick:g=>n.toggleExpanded(a.id),class:"btn-view"},r(i.expandedEmployees.has(a.id)?"View Less":"View More"),9,Q),e("button",{onClick:g=>n.viewEmployee(a),class:"btn-details"},"Full Details",8,X)])])}),128)),i.employees.length===0?(d(),l("div",Z,[...s[14]||(s[14]=[e("p",null,"No team members found",-1),e("p",null,"Contact HR to assign employees to your team.",-1)])])):h("",!0)])):(d(),l("div",C," You don't have permission to access this page. ")):(d(),l("div",x," Please log in to access employee management. "))])}const te=_(w,[["render",$],["__scopeId","data-v-808fc334"]]);export{te as default};
