import{b as d,p as t,C as f,v as h,x as s,A as x,F as c,D as y,y as r,q as C,B as b,t as g,s as w,g as M,f as u}from"./vendor-CFHPe_rb.js";import{_ as T}from"./index-cgHGa_Rg.js";const A={name:"TaxConfiguration",data(){return{pageName:"Tax Configuration",saving:!1,showPreview:!1,hasBandValidationError:!1,taxYears:[],taxConfig:{taxYear:"",currency:"ZMW",taxFreeThreshold:0,annualTaxFree:0,taxBands:[],nhimaEmployeeRate:1,nhimaEmployerRate:1,nhimaMaxSalary:null,napsaRate:5,napsaMaxSalary:34164,payGrades:[],includeHousingAllowance:!1,includeTransportAllowance:!1,taxCalculationMethod:"cumulative",roundingMethod:"nearest"}}},watch:{"taxConfig.taxBands":{handler(){this.validateTaxBands()},deep:!0}},methods:{getAxiosInstance(){return this.$axios||this.$http||M},async fetchTaxConfiguration(){try{const a=await this.getAxiosInstance().get("/api/admin/tax-configuration");a.data&&a.data.tax_configuration&&a.data.tax_configuration.config_data&&(this.taxConfig={...this.taxConfig,...a.data.tax_configuration.config_data})}catch(n){console.error("Error fetching tax configuration:",n)}},validateTaxBands(){if(this.hasBandValidationError=!1,!!this.taxConfig.taxBands)for(let n=1;n<this.taxConfig.taxBands.length;n++){const a=this.taxConfig.taxBands[n-1],p=this.taxConfig.taxBands[n];if(a.upperLimit&&p.lowerLimit!==a.upperLimit+.01){this.hasBandValidationError=!0;return}}},addTaxBand(){const n=this.taxConfig.taxBands[this.taxConfig.taxBands.length-1]||{};this.taxConfig.taxBands.push({lowerLimit:n.upperLimit?n.upperLimit+.01:0,upperLimit:null,rate:null})},removeTaxBand(n){this.taxConfig.taxBands.length>1&&this.taxConfig.taxBands.splice(n,1)},addPayGrade(){var p;const n=this.taxConfig.payGrades[this.taxConfig.payGrades.length-1]||{grade:"A",maxSalary:0},a=String.fromCharCode((((p=n.grade)==null?void 0:p.charCodeAt(0))||64)+1);this.taxConfig.payGrades.push({grade:a,name:"",minSalary:n.maxSalary+.01,maxSalary:null,description:""})},removePayGrade(n){this.taxConfig.payGrades.length>1&&this.taxConfig.payGrades.splice(n,1)},async saveTaxConfiguration(){var n,a;if(this.hasBandValidationError)return alert("Fix tax band continuity before saving.");this.saving=!0;try{this.taxConfig.taxFreeThreshold!=null&&(this.taxConfig.annualTaxFree=this.taxConfig.taxFreeThreshold*12);const v=await this.getAxiosInstance().post("/api/admin/update-tax-configuration",{taxConfig:this.taxConfig});v.data&&v.data.tax_configuration&&v.data.tax_configuration.config_data&&(this.taxConfig={...this.taxConfig,...v.data.tax_configuration.config_data}),alert(v.data.message||"Tax configuration saved successfully!")}catch(p){console.error("Error saving tax configuration:",p),alert(((a=(n=p.response)==null?void 0:n.data)==null?void 0:a.message)||"Failed to save tax configuration.")}finally{this.saving=!1}},async resetToDefault(){confirm("Reset to default 2025 Zambian tax rates?")&&await this.fetchTaxConfiguration()},previewCalculation(){this.showPreview=!0},closePreview(){this.showPreview=!1}},mounted(){const n=new Date().getFullYear();this.taxYears=Array.from({length:5},(a,p)=>String(n+p)),this.taxConfig.taxYear=String(n),this.fetchTaxConfiguration()}},S={class:"tax-configuration"},B={class:"configuration-card"},V={class:"form-section"},P={class:"form-row"},Z={class:"form-group"},E=["value"],R={class:"form-group"},U={class:"form-section"},k={class:"form-row"},G={class:"form-group"},W={class:"form-group"},F=["value"],N={class:"form-section"},_={class:"tax-bands"},Y={class:"band-header"},I=["onClick"],L={class:"form-row"},D={class:"form-group"},q=["onUpdate:modelValue","placeholder"],H={class:"form-group"},K=["onUpdate:modelValue","placeholder"],J={key:0},O={class:"form-group"},j=["onUpdate:modelValue"],z={key:0,class:"validation-note"},Q={class:"form-section"},X={class:"form-row"},$={class:"form-group"},aa={class:"form-group"},ta={class:"form-row"},oa={class:"form-group"},ea={class:"form-section"},na={class:"form-row"},sa={class:"form-group"},ia={class:"form-group"},la={class:"form-section"},ra={class:"pay-grades"},da={class:"grade-header"},ua=["onClick"],pa={class:"form-row"},ma={class:"form-group"},va=["onUpdate:modelValue"],fa={class:"form-group"},xa=["onUpdate:modelValue"],ga={class:"form-group"},ca=["onUpdate:modelValue"],ya={class:"form-row"},ha={class:"form-group full-width"},Ca=["onUpdate:modelValue"],ba={class:"form-section"},wa={class:"form-row"},Ma={class:"form-group"},Ta={class:"checkbox-label"},Aa={class:"form-group"},Sa={class:"checkbox-label"},Ba={class:"form-row"},Va={class:"form-group"},Pa={class:"form-group"},Za={class:"form-actions"},Ea=["disabled"],Ra={class:"modal"},Ua={class:"modal-header"};function ka(n,a,p,v,e,i){return u(),d("div",S,[a[62]||(a[62]=t("div",{class:"page-header"},[t("h1",null,"Tax Configuration - Zambia"),t("p",{class:"page-subtitle"},"Configure PAYE tax rates and thresholds for Zambian private sector (2025 ZRA Guidelines)")],-1)),t("div",B,[a[59]||(a[59]=t("div",{class:"card-header"},[t("h2",null,"PAYE Tax Bands & Rates"),t("p",null,"Configure tax bands according to Zambian Revenue Authority (ZRA) guidelines")],-1)),t("form",{onSubmit:a[17]||(a[17]=h((...o)=>i.saveTaxConfiguration&&i.saveTaxConfiguration(...o),["prevent"])),class:"tax-form"},[t("div",V,[a[24]||(a[24]=t("h3",null,"Tax Year Configuration",-1)),t("div",P,[t("div",Z,[a[21]||(a[21]=t("label",{for:"taxYear"},"Current Tax Year *",-1)),s(t("select",{id:"taxYear","onUpdate:modelValue":a[0]||(a[0]=o=>e.taxConfig.taxYear=o),required:""},[a[20]||(a[20]=t("option",{value:""},"Select Tax Year",-1)),(u(!0),d(c,null,y(e.taxYears,o=>(u(),d("option",{key:o,value:o},g(o),9,E))),128))],512),[[x,e.taxConfig.taxYear]])]),t("div",R,[a[23]||(a[23]=t("label",{for:"currency"},"Currency *",-1)),s(t("select",{id:"currency","onUpdate:modelValue":a[1]||(a[1]=o=>e.taxConfig.currency=o),required:""},[...a[22]||(a[22]=[t("option",{value:"ZMW"},"Zambian Kwacha (ZMW)",-1),t("option",{value:"USD"},"US Dollar (USD)",-1)])],512),[[x,e.taxConfig.currency]])])])]),t("div",U,[a[29]||(a[29]=t("h3",null,"Tax-Free Allowances",-1)),t("div",k,[t("div",G,[a[25]||(a[25]=t("label",{for:"taxFreeThreshold"},"Monthly Tax-Free Threshold (ZMW) *",-1)),s(t("input",{id:"taxFreeThreshold","onUpdate:modelValue":a[2]||(a[2]=o=>e.taxConfig.taxFreeThreshold=o),type:"number",step:"0.01",min:"0",required:"",placeholder:"e.g., 5100.00"},null,512),[[r,e.taxConfig.taxFreeThreshold,void 0,{number:!0}]]),a[26]||(a[26]=t("small",null,"Monthly income exempt from PAYE tax (0% band)",-1))]),t("div",W,[a[27]||(a[27]=t("label",{for:"annualTaxFree"},"Annual Tax-Free Threshold (ZMW)",-1)),s(t("input",{id:"annualTaxFree","onUpdate:modelValue":a[3]||(a[3]=o=>e.taxConfig.annualTaxFree=o),type:"number",step:"0.01",min:"0",readonly:"",value:e.taxConfig.taxFreeThreshold*12},null,8,F),[[r,e.taxConfig.annualTaxFree,void 0,{number:!0}]]),a[28]||(a[28]=t("small",null,"Calculated automatically (Monthly × 12)",-1))])])]),t("div",N,[a[33]||(a[33]=t("h3",null,"PAYE Tax Bands (Progressive on Taxable Gross)",-1)),t("div",_,[(u(!0),d(c,null,y(e.taxConfig.taxBands,(o,m)=>(u(),d("div",{key:m,class:"tax-band"},[t("div",Y,[t("h4",null,"Band "+g(m+1),1),e.taxConfig.taxBands.length>1?(u(),d("button",{key:0,type:"button",class:"btn-remove",onClick:l=>i.removeTaxBand(m)}," Remove ",8,I)):f("",!0)]),t("div",L,[t("div",D,[a[30]||(a[30]=t("label",null,"Lower Limit (ZMW) *",-1)),s(t("input",{"onUpdate:modelValue":l=>o.lowerLimit=l,type:"number",step:"0.01",min:"0",required:"",placeholder:m===0?"0.00":`Above ${e.taxConfig.taxBands[m-1].upperLimit}`},null,8,q),[[r,o.lowerLimit,void 0,{number:!0}]])]),t("div",H,[a[31]||(a[31]=t("label",null,"Upper Limit (ZMW)",-1)),s(t("input",{"onUpdate:modelValue":l=>o.upperLimit=l,type:"number",step:"0.01",min:"0",placeholder:m===e.taxConfig.taxBands.length-1?"No upper limit":"Enter upper limit"},null,8,K),[[r,o.upperLimit,void 0,{number:!0}]]),m===e.taxConfig.taxBands.length-1?(u(),d("small",J,"Leave empty for no upper limit")):f("",!0)]),t("div",O,[a[32]||(a[32]=t("label",null,"Tax Rate (%) *",-1)),s(t("input",{"onUpdate:modelValue":l=>o.rate=l,type:"number",step:"0.01",min:"0",max:"100",required:"",placeholder:"e.g., 20.00"},null,8,j),[[r,o.rate,void 0,{number:!0}]])])])]))),128))]),t("button",{type:"button",class:"btn-add-band",onClick:a[4]||(a[4]=(...o)=>i.addTaxBand&&i.addTaxBand(...o))}," + Add Another Tax Band "),e.hasBandValidationError?(u(),d("small",z,"Ensure bands are continuous (next lower = prev upper + 0.01)")):f("",!0)]),t("div",Q,[a[40]||(a[40]=t("h3",null,"NHIMA Contributions (1% Employee on Gross after Bonuses)",-1)),t("div",X,[t("div",$,[a[34]||(a[34]=t("label",{for:"nhimaEmployeeRate"},"Employee Contribution Rate (%) *",-1)),s(t("input",{id:"nhimaEmployeeRate","onUpdate:modelValue":a[5]||(a[5]=o=>e.taxConfig.nhimaEmployeeRate=o),type:"number",step:"0.01",min:"0",max:"10",required:"",placeholder:"e.g., 1.00"},null,512),[[r,e.taxConfig.nhimaEmployeeRate,void 0,{number:!0}]]),a[35]||(a[35]=t("small",null,"Percentage of gross salary (after bonuses) deducted for NHIMA",-1))]),t("div",aa,[a[36]||(a[36]=t("label",{for:"nhimaEmployerRate"},"Employer Contribution Rate (%) *",-1)),s(t("input",{id:"nhimaEmployerRate","onUpdate:modelValue":a[6]||(a[6]=o=>e.taxConfig.nhimaEmployerRate=o),type:"number",step:"0.01",min:"0",max:"10",required:"",placeholder:"e.g., 1.00"},null,512),[[r,e.taxConfig.nhimaEmployerRate,void 0,{number:!0}]]),a[37]||(a[37]=t("small",null,"Percentage of gross salary paid by employer",-1))])]),t("div",ta,[t("div",oa,[a[38]||(a[38]=t("label",{for:"nhimaMaxSalary"},"Maximum Salary for NHIMA (ZMW)",-1)),s(t("input",{id:"nhimaMaxSalary","onUpdate:modelValue":a[7]||(a[7]=o=>e.taxConfig.nhimaMaxSalary=o),type:"number",step:"0.01",min:"0",placeholder:"e.g., 50000.00"},null,512),[[r,e.taxConfig.nhimaMaxSalary,void 0,{number:!0}]]),a[39]||(a[39]=t("small",null,"Salary cap for NHIMA contributions (optional)",-1))])])]),t("div",ea,[a[45]||(a[45]=t("h3",null,"Other Statutory Deductions",-1)),t("div",na,[t("div",sa,[a[41]||(a[41]=t("label",{for:"napsaRate"},"NAPSA Employee Contribution Rate (%)",-1)),s(t("input",{id:"napsaRate","onUpdate:modelValue":a[8]||(a[8]=o=>e.taxConfig.napsaRate=o),type:"number",step:"0.01",min:"0",max:"10",placeholder:"e.g., 5.00"},null,512),[[r,e.taxConfig.napsaRate,void 0,{number:!0}]]),a[42]||(a[42]=t("small",null,"National Pension Scheme Authority employee contribution rate (cap at ZMW 1,708.20)",-1))]),t("div",ia,[a[43]||(a[43]=t("label",{for:"napsaMaxSalary"},"NAPSA Maximum Assessable Salary (ZMW)",-1)),s(t("input",{id:"napsaMaxSalary","onUpdate:modelValue":a[9]||(a[9]=o=>e.taxConfig.napsaMaxSalary=o),type:"number",step:"0.01",min:"0",placeholder:"e.g., 34164.00"},null,512),[[r,e.taxConfig.napsaMaxSalary,void 0,{number:!0}]]),a[44]||(a[44]=t("small",null,"Salary cap for NAPSA (5% yields max ZMW 1,708.20 employee contrib.)",-1))])])]),t("div",la,[a[50]||(a[50]=t("h3",null,"Pay Grades & Salary Bands",-1)),t("div",ra,[(u(!0),d(c,null,y(e.taxConfig.payGrades,(o,m)=>(u(),d("div",{key:m,class:"pay-grade"},[t("div",da,[t("h4",null,"Grade "+g(o.grade),1),e.taxConfig.payGrades.length>1?(u(),d("button",{key:0,type:"button",class:"btn-remove",onClick:l=>i.removePayGrade(m)}," Remove ",8,ua)):f("",!0)]),t("div",pa,[t("div",ma,[a[46]||(a[46]=t("label",null,"Grade Name *",-1)),s(t("input",{"onUpdate:modelValue":l=>o.name=l,type:"text",required:"",placeholder:"e.g., Junior Staff, Management"},null,8,va),[[r,o.name]])]),t("div",fa,[a[47]||(a[47]=t("label",null,"Minimum Salary (ZMW) *",-1)),s(t("input",{"onUpdate:modelValue":l=>o.minSalary=l,type:"number",step:"0.01",min:"0",required:"",placeholder:"e.g., 5000.00"},null,8,xa),[[r,o.minSalary,void 0,{number:!0}]])]),t("div",ga,[a[48]||(a[48]=t("label",null,"Maximum Salary (ZMW) *",-1)),s(t("input",{"onUpdate:modelValue":l=>o.maxSalary=l,type:"number",step:"0.01",min:"0",required:"",placeholder:"e.g., 10000.00"},null,8,ca),[[r,o.maxSalary,void 0,{number:!0}]])])]),t("div",ya,[t("div",ha,[a[49]||(a[49]=t("label",null,"Description",-1)),s(t("textarea",{"onUpdate:modelValue":l=>o.description=l,rows:"2",placeholder:"Brief description of this pay grade..."},null,8,Ca),[[r,o.description]])])])]))),128))]),t("button",{type:"button",class:"btn-add-grade",onClick:a[10]||(a[10]=(...o)=>i.addPayGrade&&i.addPayGrade(...o))}," + Add Another Pay Grade ")]),t("div",ba,[a[58]||(a[58]=t("h3",null,"Additional Settings",-1)),t("div",wa,[t("div",Ma,[t("label",Ta,[s(t("input",{type:"checkbox","onUpdate:modelValue":a[11]||(a[11]=o=>e.taxConfig.includeHousingAllowance=o)},null,512),[[b,e.taxConfig.includeHousingAllowance]]),a[51]||(a[51]=C(" Include Housing Allowance in Taxable Income ",-1))])]),t("div",Aa,[t("label",Sa,[s(t("input",{type:"checkbox","onUpdate:modelValue":a[12]||(a[12]=o=>e.taxConfig.includeTransportAllowance=o)},null,512),[[b,e.taxConfig.includeTransportAllowance]]),a[52]||(a[52]=C(" Include Transport Allowance in Taxable Income ",-1))])])]),t("div",Ba,[t("div",Va,[a[54]||(a[54]=t("label",{for:"taxCalculationMethod"},"Tax Calculation Method *",-1)),s(t("select",{id:"taxCalculationMethod","onUpdate:modelValue":a[13]||(a[13]=o=>e.taxConfig.taxCalculationMethod=o),required:""},[...a[53]||(a[53]=[t("option",{value:"cumulative"},"Cumulative (Progressive)",-1),t("option",{value:"non_cumulative"},"Non-Cumulative",-1)])],512),[[x,e.taxConfig.taxCalculationMethod]]),a[55]||(a[55]=t("small",null,"Cumulative: Tax calculated on year-to-date income",-1))]),t("div",Pa,[a[57]||(a[57]=t("label",{for:"roundingMethod"},"Rounding Method *",-1)),s(t("select",{id:"roundingMethod","onUpdate:modelValue":a[14]||(a[14]=o=>e.taxConfig.roundingMethod=o),required:""},[...a[56]||(a[56]=[t("option",{value:"nearest"},"Nearest Kwacha",-1),t("option",{value:"up"},"Round Up",-1),t("option",{value:"down"},"Round Down",-1),t("option",{value:"none"},"No Rounding",-1)])],512),[[x,e.taxConfig.roundingMethod]])])])]),t("div",Za,[t("button",{type:"button",class:"btn-secondary",onClick:a[15]||(a[15]=(...o)=>i.resetToDefault&&i.resetToDefault(...o))}," Reset to Default (2025 ZRA) "),t("button",{type:"button",class:"btn-secondary",onClick:a[16]||(a[16]=(...o)=>i.previewCalculation&&i.previewCalculation(...o))}," Preview Calculation "),t("button",{type:"submit",class:"btn-primary",disabled:e.saving||e.hasBandValidationError},g(e.saving?"Saving...":"Save Tax Configuration"),9,Ea)])],32)]),e.showPreview?(u(),d("div",{key:0,class:"modal-overlay",onClick:a[19]||(a[19]=h((...o)=>i.closePreview&&i.closePreview(...o),["self"]))},[t("div",Ra,[t("div",Ua,[a[60]||(a[60]=t("h3",null,"Tax Calculation Preview (Sample: Basic ZMW 7,556.80 → Gross ZMW 10,000)",-1)),t("button",{onClick:a[18]||(a[18]=(...o)=>i.closePreview&&i.closePreview(...o)),class:"close-btn"},"✕")]),a[61]||(a[61]=w('<div class="modal-body" data-v-9655a748><div class="preview-content" data-v-9655a748><h4 data-v-9655a748>Allowances Breakdown</h4><div class="calculation-breakdown" data-v-9655a748><div class="calculation-row" data-v-9655a748><span data-v-9655a748>Basic Pay:</span><span data-v-9655a748>ZMW 7,556.80</span></div><div class="calculation-row" data-v-9655a748><span data-v-9655a748>Housing (25% Basic):</span><span data-v-9655a748>ZMW 1,889.20</span></div><div class="calculation-row" data-v-9655a748><span data-v-9655a748>Transport:</span><span data-v-9655a748>ZMW 300.00</span></div><div class="calculation-row" data-v-9655a748><span data-v-9655a748>Lunch:</span><span data-v-9655a748>ZMW 240.00</span></div><div class="calculation-row total" data-v-9655a748><span data-v-9655a748>Gross Earnings:</span><span data-v-9655a748>ZMW 9,986.00</span></div></div><h4 data-v-9655a748>Deductions Breakdown</h4><div class="calculation-breakdown" data-v-9655a748><div class="calculation-row" data-v-9655a748><span data-v-9655a748>Taxable Income (Gross):</span><span data-v-9655a748>ZMW 9,986.00</span></div><div class="calculation-row" data-v-9655a748><span data-v-9655a748>PAYE Tax:</span><span data-v-9655a748>ZMW 1,320.22</span></div><div class="calculation-row" data-v-9655a748><span data-v-9655a748>NAPSA (5% Gross, capped):</span><span data-v-9655a748>ZMW 499.30</span></div><div class="calculation-row" data-v-9655a748><span data-v-9655a748>NHIMA (1% Gross after bonuses):</span><span data-v-9655a748>ZMW 99.86</span></div><div class="calculation-row total" data-v-9655a748><span data-v-9655a748>Net Salary:</span><span data-v-9655a748>ZMW 8,066.62</span></div></div><small data-v-9655a748>Full logic applied in backend (progressive PAYE, NAPSA cap ZMW 1,708.20, NHIMA on gross post-bonuses).</small></div></div>',1))])])):f("",!0)])}const Fa=T(A,[["render",ka],["__scopeId","data-v-9655a748"]]);export{Fa as default};
