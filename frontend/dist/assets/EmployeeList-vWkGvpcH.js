import{_ as b,u as E}from"./index-CUA5mSp8.js";import{b as i,p as e,C as u,q as p,t as n,F as _,D as f,v as P,g as k,f as r,z as w}from"./vendor-CFHPe_rb.js";const C={name:"EmployeeList",setup(){return{authStore:E()}},data(){return{employees:[],loading:!1,error:null,retryCount:0,currentPage:1,itemsPerPage:10,selectedEmployee:null}},computed:{paginatedEmployees(){const o=(this.currentPage-1)*this.itemsPerPage,s=o+this.itemsPerPage;return this.employees.slice(o,s)},totalPages(){return Math.ceil(this.employees.length/this.itemsPerPage)}},mounted(){this.initializeComponent()},methods:{initializeComponent(){if(!this.authStore.isAuthenticated){this.error="Please log in to access employee management.";return}if(!this.authStore.isManager){this.error="You do not have permission to access this page.";return}this.fetchEmployees()},async fetchEmployees(o=!1){var s;this.loading=!0,this.error=null;try{const d=await k.get("/api/manager/employees",{params:{manager_id:(s=this.authStore.user)==null?void 0:s.id}});this.employees=d.data.data||d.data}catch(d){console.error("Fetch error:",d),this.handleApiError(d)}finally{this.loading=!1}},retryFetch(){this.retryCount++,this.retryCount<=3?this.fetchEmployees(!0):this.error="Max retries exceeded. Check your network or server."},handleApiError(o){var d,m,t,a;let s="An unexpected error occurred. (Likely CORS - check console)";o.code==="ERR_NETWORK"||o.message.includes("Network Error")?s="Network/CORS error: Ensure backend allows requests from localhost:3000":((d=o.response)==null?void 0:d.status)===401?(s="Your session has expired. Please log in again.",this.authStore.clearAuth(),this.$router.push({name:"login"})):((m=o.response)==null?void 0:m.status)===403?s="You do not have permission to perform this action.":s=((a=(t=o.response)==null?void 0:t.data)==null?void 0:a.message)||s,this.error=s},viewEmployeeDetails(o){this.selectedEmployee=o},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},prevPage(){this.currentPage>1&&this.currentPage--},goToPage(o){this.currentPage=o},getInitials(o){return o?o.split(" ").map(s=>s[0]).join("").toUpperCase().substring(0,2):"??"},formatNumber(o){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(o||0)},formatDate(o){return o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"},formatEmploymentType(o){return{full_time:"Full Time",part_time:"Part Time",contract:"Contract"}[o]||o}}},N={class:"employee-management"},D={key:0,class:"error-message"},S={key:1,class:"error-message"},x={key:2,class:"loading"},A={key:3,class:"error-message"},T={key:4,class:"table-container"},F={class:"table-header"},M={class:"employees-table"},R={class:"employee-name"},I={class:"employee-avatar"},L={class:"salary"},z={class:"badge"},B=["onClick"],V={key:0,class:"pagination"},Y=["disabled"],H=["onClick"],K=["disabled"],O={key:1,class:"empty-state"},U={class:"modal-card"},q={class:"modal-header"},j={class:"modal-body"},W={class:"detail-section"},G={class:"detail-grid"},J={class:"detail-row"},Q={class:"detail-row"},X={class:"detail-row"},Z={class:"detail-row"},$={class:"badge"},ee={class:"detail-row"},se={class:"detail-row"},te={class:"detail-section"},le={class:"detail-grid"},oe={class:"detail-row"},ne={class:"detail-row"},ae={class:"detail-row"},ie={class:"detail-row"},re={class:"detail-section"},de={class:"detail-grid"},me={class:"detail-row"},ce={class:"badge rating-badge"},ue={class:"detail-row"},pe={class:"detail-row full-width"},ye={class:"notes"},he={class:"modal-footer"};function ge(o,s,d,m,t,a){var y,h;return r(),i("div",N,[s[26]||(s[26]=e("div",{class:"page-header"},[e("h1",null,"My Team - Employee Management")],-1)),m.authStore.isAuthenticated?m.authStore.isManager?t.loading?(r(),i("div",x,[...s[6]||(s[6]=[e("div",{class:"spinner"},null,-1),e("p",null,"Loading team members...",-1)])])):t.error?(r(),i("div",A,[p(n(t.error)+" ",1),e("button",{onClick:s[0]||(s[0]=(...l)=>a.retryFetch&&a.retryFetch(...l)),class:"btn-primary"},"Retry")])):(r(),i("div",T,[e("div",F,[e("h2",null,"Team Members ("+n(t.employees.length)+")",1)]),e("table",M,[s[8]||(s[8]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Employee ID"),e("th",null,"Email"),e("th",null,"Position"),e("th",null,"Department"),e("th",null,"Salary (K)"),e("th",null,"Hire Date"),e("th",null,"Type"),e("th",null,"Actions")])],-1)),e("tbody",null,[(r(!0),i(_,null,f(a.paginatedEmployees,l=>{var c,g,v;return r(),i("tr",{key:l.id},[e("td",null,[e("div",R,[e("div",I,n(a.getInitials(l.full_name||((c=l.user)==null?void 0:c.name))),1),p(" "+n(l.full_name||((g=l.user)==null?void 0:g.name)),1)])]),e("td",null,n(l.employee_id),1),e("td",null,n(l.email||((v=l.user)==null?void 0:v.email)),1),e("td",null,n(l.position),1),e("td",null,n(l.department),1),e("td",L,n(a.formatNumber(l.base_salary)),1),e("td",null,n(a.formatDate(l.hire_date)),1),e("td",null,[e("span",z,n(a.formatEmploymentType(l.employment_type)),1)]),e("td",null,[e("button",{onClick:ve=>a.viewEmployeeDetails(l),class:"action-btn view"},[...s[7]||(s[7]=[e("i",{class:"icon icon-eye"},null,-1),p(" View ",-1)])],8,B)])])}),128))])]),t.employees.length>t.itemsPerPage?(r(),i("div",V,[e("button",{onClick:s[1]||(s[1]=(...l)=>a.prevPage&&a.prevPage(...l)),disabled:t.currentPage===1,class:"pagination-btn"},"Previous",8,Y),(r(!0),i(_,null,f(a.totalPages,l=>(r(),i("span",{key:l,class:w(["page-number",{active:t.currentPage===l}]),onClick:c=>a.goToPage(l)},n(l),11,H))),128)),e("button",{onClick:s[2]||(s[2]=(...l)=>a.nextPage&&a.nextPage(...l)),disabled:t.currentPage===a.totalPages,class:"pagination-btn"},"Next",8,K)])):u("",!0),t.employees.length===0?(r(),i("div",O,[...s[9]||(s[9]=[e("i",{class:"icon icon-empty"},null,-1),e("p",null,"No team members found",-1),e("p",null,"Contact HR to assign employees to your team.",-1)])])):u("",!0)])):(r(),i("div",S," You don't have permission to access this page. ")):(r(),i("div",D," Please log in to access employee management. ")),t.selectedEmployee?(r(),i("div",{key:5,class:"modal-overlay",onClick:s[5]||(s[5]=P(l=>t.selectedEmployee=null,["self"]))},[e("div",U,[e("div",q,[e("h2",null,n(t.selectedEmployee.full_name||((y=t.selectedEmployee.user)==null?void 0:y.name))+"'s Details",1),e("button",{onClick:s[3]||(s[3]=l=>t.selectedEmployee=null),class:"close-btn"},"âœ•")]),e("div",j,[e("div",W,[s[16]||(s[16]=e("div",{class:"card-header"},[e("h3",null,"Basic Information"),e("i",{class:"icon icon-user"})],-1)),e("div",G,[e("div",J,[s[10]||(s[10]=e("span",{class:"label"},"Employee ID:",-1)),e("span",null,n(t.selectedEmployee.employee_id),1)]),e("div",Q,[s[11]||(s[11]=e("span",{class:"label"},"Position:",-1)),e("span",null,n(t.selectedEmployee.position),1)]),e("div",X,[s[12]||(s[12]=e("span",{class:"label"},"Department:",-1)),e("span",null,n(t.selectedEmployee.department),1)]),e("div",Z,[s[13]||(s[13]=e("span",{class:"label"},"Employment Type:",-1)),e("span",$,n(a.formatEmploymentType(t.selectedEmployee.employment_type)),1)]),e("div",ee,[s[14]||(s[14]=e("span",{class:"label"},"Salary:",-1)),e("span",null,"K"+n(a.formatNumber(t.selectedEmployee.base_salary)),1)]),e("div",se,[s[15]||(s[15]=e("span",{class:"label"},"Hire Date:",-1)),e("span",null,n(a.formatDate(t.selectedEmployee.hire_date)),1)])])]),e("div",te,[s[21]||(s[21]=e("div",{class:"card-header"},[e("h3",null,"Contact Information"),e("i",{class:"icon icon-phone"})],-1)),e("div",le,[e("div",oe,[s[17]||(s[17]=e("span",{class:"label"},"Email:",-1)),e("span",null,n(t.selectedEmployee.email||((h=t.selectedEmployee.user)==null?void 0:h.email)),1)]),e("div",ne,[s[18]||(s[18]=e("span",{class:"label"},"Phone:",-1)),e("span",null,n(t.selectedEmployee.phone||"N/A"),1)]),e("div",ae,[s[19]||(s[19]=e("span",{class:"label"},"Address:",-1)),e("span",null,n(t.selectedEmployee.address||"N/A"),1)]),e("div",ie,[s[20]||(s[20]=e("span",{class:"label"},"Emergency Contact:",-1)),e("span",null,n(t.selectedEmployee.emergency_contact||"N/A"),1)])])]),e("div",re,[s[25]||(s[25]=e("div",{class:"card-header"},[e("h3",null,"Performance & Notes"),e("i",{class:"icon icon-star"})],-1)),e("div",de,[e("div",me,[s[22]||(s[22]=e("span",{class:"label"},"Performance Rating:",-1)),e("span",ce,n(t.selectedEmployee.performance_rating||"N/A"),1)]),e("div",ue,[s[23]||(s[23]=e("span",{class:"label"},"Last Review Date:",-1)),e("span",null,n(a.formatDate(t.selectedEmployee.last_review_date)),1)]),e("div",pe,[s[24]||(s[24]=e("span",{class:"label"},"Notes:",-1)),e("span",ye,n(t.selectedEmployee.notes||"No notes available"),1)])])])]),e("div",he,[e("button",{onClick:s[4]||(s[4]=l=>t.selectedEmployee=null),class:"btn-secondary"},"Close")])])])):u("",!0)])}const be=b(C,[["render",ge],["__scopeId","data-v-185fffb9"]]);export{be as default};
