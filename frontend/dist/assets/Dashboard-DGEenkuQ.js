import{_ as x,u as k}from"./index-cgHGa_Rg.js";import{b as o,p as t,C as v,t as n,s as c,F as _,D as g,a as b,w as D,e as C,g as B,f as i,E as L,q as S,z as j}from"./vendor-CFHPe_rb.js";const N={name:"EmployeeDashboard",setup(){return{authStore:k()}},data(){return{pageName:"Employee Dashboard",stats:{},loading:!1,error:null,retryCount:0,currentDate:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}},mounted(){this.initializeComponent()},methods:{initializeComponent(){if(!this.authStore.isAuthenticated){this.error="Please log in to access the dashboard.",this.$router.push({name:"login"});return}this.fetchDashboardData(),this.refreshInterval=setInterval(()=>{this.fetchDashboardData(!0)},3e5)},async fetchDashboardData(s=!1){s||(this.loading=!0),this.error=null;try{const e=await B.get("/api/dashboard");if(e.data.role==="employee"&&e.data.stats){const d=this.stats.leave_balances||{};this.stats=e.data.stats,!s&&this.hasBalancesChanged(d,this.stats.leave_balances)&&this.showBalanceUpdateNotification()}else e.data.role!=="employee"&&(this.error="This dashboard is for employees only.")}catch(e){console.error("Dashboard fetch error:",e),s||this.handleApiError(e)}finally{s||(this.loading=!1)}},hasBalancesChanged(s,e){if(!s||Object.keys(s).length===0)return!1;for(const d in e)if(s[d]!==e[d])return!0;return!1},showBalanceUpdateNotification(){this.$notify&&this.$notify({type:"info",title:"Leave Balances Updated",text:"Your leave balances have been updated based on new company policies.",duration:5e3})},getTotalLeaveBalance(){return this.stats.leave_balances?Object.values(this.stats.leave_balances).reduce((s,e)=>s+e,0):0},formatHours(s){return s?parseFloat(s).toFixed(2):"0.00"},formatLeaveType(s){return s?{annual:"Annual Leave",sick:"Sick Leave",maternity:"Maternity Leave",paternity:"Paternity Leave",bereavement:"Bereavement Leave",unpaid:"Unpaid Leave"}[s.toLowerCase()]||s.split("_").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" "):"N/A"},formatDate(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"},calculateProgress(s){return Math.min(s/30*100,100)}},beforeUnmount(){this.refreshInterval&&clearInterval(this.refreshInterval)}},M={class:"dashboard-view"},A={class:"dashboard-header"},T={class:"header-content"},E={class:"user-info"},H={class:"welcome-title"},P={class:"date-display"},U={class:"current-date"},F={key:0,class:"summary-cards"},V={class:"card"},z={class:"value"},I={class:"card"},O={class:"value"},R={class:"card"},q={class:"value"},W={class:"card"},Y={class:"value"},G={key:1,class:"dashboard-content"},J={class:"content-section"},K={class:"section-column"},Q={key:0,class:"info-card"},X={class:"attendance-grid"},Z={class:"attendance-item"},$={class:"attendance-details"},tt={class:"value"},et={class:"attendance-item"},st={class:"attendance-details"},at={class:"value"},nt={class:"attendance-item"},ot={class:"attendance-details"},it={class:"value"},lt={class:"attendance-item"},rt={class:"attendance-details"},dt={class:"value"},ct={class:"section-column"},vt={class:"info-card"},ht={class:"card-header"},ut={class:"leave-balances"},pt={class:"leave-type-info"},yt={class:"leave-type"},mt={class:"leave-days"},_t={class:"leave-progress"},gt={class:"progress-bar"},wt={key:0,class:"empty-state"},ft={class:"content-section"},xt={class:"section-column wide"},kt={class:"info-card"},bt={class:"card-header"},Dt={class:"card-actions"},Ct={key:0,class:"table-container"},Bt={class:"records-table"},Lt={class:"leave-type-cell"},St={class:"leave-type-badge"},jt={class:"reason-cell"},Nt={key:1,class:"empty-state"},Mt={class:"section-column"},At={class:"info-card"},Tt={key:0,class:"payslip-info"},Et={class:"payslip-details"},Ht={class:"payslip-detail"},Pt={class:"value"},Ut={class:"payslip-detail"},Ft={class:"value"},Vt={class:"payslip-detail"},zt={class:"value"},It={key:1,class:"empty-state"},Ot={key:2,class:"loading"},Rt={key:3,class:"error-message"};function qt(s,e,d,w,a,r){var h,u,p,y;const f=C("router-link");return i(),o("div",M,[t("header",A,[t("div",T,[t("div",E,[t("h1",H,"Welcome back, "+n(((h=w.authStore.user)==null?void 0:h.name)||"Employee")+"!",1),e[1]||(e[1]=t("p",{class:"subtitle"},"Here's what's happening with your payroll and records.",-1))]),t("div",P,[t("span",U,n(a.currentDate),1)])])]),a.loading?v("",!0):(i(),o("div",F,[t("div",V,[e[2]||(e[2]=c('<div class="card-icon present" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><rect x="3" y="4" width="18" height="18" rx="2" ry="2" data-v-c056e928></rect><line x1="16" y1="2" x2="16" y2="6" data-v-c056e928></line><line x1="8" y1="2" x2="8" y2="6" data-v-c056e928></line><line x1="3" y1="10" x2="21" y2="10" data-v-c056e928></line></svg></div><h3 data-v-c056e928>Present Days</h3>',2)),t("p",z,n(((u=a.stats.attendance_summary)==null?void 0:u.present_days)||0),1),e[3]||(e[3]=t("span",{class:"card-subtitle"},"This month",-1))]),t("div",I,[e[4]||(e[4]=t("div",{class:"card-icon hours"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})])],-1)),e[5]||(e[5]=t("h3",null,"Total Hours",-1)),t("p",O,n(r.formatHours((p=a.stats.attendance_summary)==null?void 0:p.total_hours)||"0.00"),1),e[6]||(e[6]=t("span",{class:"card-subtitle"},"Worked hours",-1))]),t("div",R,[e[7]||(e[7]=t("div",{class:"card-icon leave"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M5 12h14"}),t("path",{d:"M12 5l7 7-7 7"})])],-1)),e[8]||(e[8]=t("h3",null,"Leave Balance",-1)),t("p",q,n(r.getTotalLeaveBalance()),1),e[9]||(e[9]=t("span",{class:"card-subtitle"},"Available days",-1))]),t("div",W,[e[10]||(e[10]=t("div",{class:"card-icon overtime"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 10"})])],-1)),e[11]||(e[11]=t("h3",null,"Overtime Hours",-1)),t("p",Y,n(r.formatHours((y=a.stats.attendance_summary)==null?void 0:y.overtime_hours)||"0.00"),1),e[12]||(e[12]=t("span",{class:"card-subtitle"},"Extra hours",-1))])])),a.loading?v("",!0):(i(),o("div",G,[t("div",J,[t("div",K,[a.stats.attendance_summary?(i(),o("div",Q,[e[21]||(e[21]=c('<div class="card-header" data-v-c056e928><h3 data-v-c056e928>This Month&#39;s Attendance</h3><div class="card-actions" data-v-c056e928><button class="btn-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><circle cx="12" cy="12" r="10" data-v-c056e928></circle><line x1="12" y1="8" x2="12" y2="12" data-v-c056e928></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-c056e928></line></svg></button></div></div>',1)),t("div",X,[t("div",Z,[e[14]||(e[14]=t("div",{class:"attendance-indicator present"},null,-1)),t("div",$,[e[13]||(e[13]=t("span",{class:"label"},"Present",-1)),t("span",tt,n(a.stats.attendance_summary.present_days||0)+" days",1)])]),t("div",et,[e[16]||(e[16]=t("div",{class:"attendance-indicator absent"},null,-1)),t("div",st,[e[15]||(e[15]=t("span",{class:"label"},"Absent",-1)),t("span",at,n(a.stats.attendance_summary.absent_days||0)+" days",1)])]),t("div",nt,[e[18]||(e[18]=t("div",{class:"attendance-indicator late"},null,-1)),t("div",ot,[e[17]||(e[17]=t("span",{class:"label"},"Late",-1)),t("span",it,n(a.stats.attendance_summary.late_days||0)+" days",1)])]),t("div",lt,[e[20]||(e[20]=t("div",{class:"attendance-indicator total"},null,-1)),t("div",rt,[e[19]||(e[19]=t("span",{class:"label"},"Total Hours",-1)),t("span",dt,n(r.formatHours(a.stats.attendance_summary.total_hours)||"0.00")+" hrs",1)])])])])):v("",!0)]),t("div",ct,[t("div",vt,[t("div",ht,[t("h3",null,"Leave Balances ("+n(new Date().getFullYear())+")",1),e[22]||(e[22]=c('<div class="card-actions" data-v-c056e928><button class="btn-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><circle cx="12" cy="12" r="10" data-v-c056e928></circle><line x1="12" y1="8" x2="12" y2="12" data-v-c056e928></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-c056e928></line></svg></button></div>',1))]),t("div",ut,[(i(!0),o(_,null,g(a.stats.leave_balances,(l,m)=>(i(),o("div",{key:m,class:"leave-item"},[t("div",pt,[t("span",yt,n(r.formatLeaveType(m)),1),t("span",mt,n(l)+" days",1)]),t("div",_t,[t("div",gt,[t("div",{class:"progress-fill",style:L({width:r.calculateProgress(l)+"%"})},null,4)])])]))),128)),Object.keys(a.stats.leave_balances||{}).length===0?(i(),o("div",wt,[...e[23]||(e[23]=[t("p",null,"No leave balances available",-1)])])):v("",!0)])])])]),t("div",ft,[t("div",xt,[t("div",kt,[t("div",bt,[e[25]||(e[25]=t("h3",null,"Recent Leave Requests",-1)),t("div",Dt,[b(f,{to:"/employee/leaves",class:"view-all"},{default:D(()=>[...e[24]||(e[24]=[S("View All",-1)])]),_:1})])]),a.stats.recent_leaves&&a.stats.recent_leaves.length>0?(i(),o("div",Ct,[t("table",Bt,[e[26]||(e[26]=t("thead",null,[t("tr",null,[t("th",null,"Type"),t("th",null,"Start Date"),t("th",null,"End Date"),t("th",null,"Days"),t("th",null,"Status"),t("th",null,"Reason")])],-1)),t("tbody",null,[(i(!0),o(_,null,g(a.stats.recent_leaves,l=>(i(),o("tr",{key:l.id},[t("td",null,[t("div",Lt,[t("span",St,n(r.formatLeaveType(l.type)),1)])]),t("td",null,n(r.formatDate(l.start_date)),1),t("td",null,n(r.formatDate(l.end_date)),1),t("td",null,n(l.number_of_days||0),1),t("td",null,[t("span",{class:j(["status",l.status.toLowerCase()])},n(l.status),3)]),t("td",jt,n(l.reason||"N/A"),1)]))),128))])])])):(i(),o("div",Nt,[...e[27]||(e[27]=[c('<div class="empty-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" data-v-c056e928></path><polyline points="14 2 14 8 20 8" data-v-c056e928></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-c056e928></line><line x1="16" y1="17" x2="8" y2="17" data-v-c056e928></line><polyline points="10 9 9 9 8 9" data-v-c056e928></polyline></svg></div><p data-v-c056e928>No recent leave requests.</p>',2)])]))])]),t("div",Mt,[t("div",At,[e[33]||(e[33]=c('<div class="card-header" data-v-c056e928><h3 data-v-c056e928>Next Payslip</h3><div class="card-actions" data-v-c056e928><button class="btn-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><circle cx="12" cy="12" r="10" data-v-c056e928></circle><line x1="12" y1="8" x2="12" y2="12" data-v-c056e928></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-c056e928></line></svg></button></div></div>',1)),a.stats.upcoming_payslip?(i(),o("div",Tt,[e[31]||(e[31]=c('<div class="payslip-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><rect x="2" y="4" width="20" height="16" rx="2" data-v-c056e928></rect><path d="M6 8h12" data-v-c056e928></path><path d="M6 12h12" data-v-c056e928></path><path d="M6 16h6" data-v-c056e928></path></svg></div>',1)),t("div",Et,[t("div",Ht,[e[28]||(e[28]=t("span",{class:"label"},"Period:",-1)),t("span",Pt,n(a.stats.upcoming_payslip.payroll_period),1)]),t("div",Ut,[e[29]||(e[29]=t("span",{class:"label"},"Processing Date:",-1)),t("span",Ft,n(r.formatDate(a.stats.upcoming_payslip.processing_date)),1)]),t("div",Vt,[e[30]||(e[30]=t("span",{class:"label"},"Estimated Days:",-1)),t("span",zt,n(a.stats.upcoming_payslip.estimated_days)+" days",1)])])])):(i(),o("div",It,[...e[32]||(e[32]=[c('<div class="empty-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><rect x="2" y="4" width="20" height="16" rx="2" data-v-c056e928></rect><path d="M6 8h12" data-v-c056e928></path><path d="M6 12h12" data-v-c056e928></path><path d="M6 16h6" data-v-c056e928></path></svg></div><p data-v-c056e928>No upcoming payslip information available.</p>',2)])]))])])])])),a.loading?(i(),o("div",Ot,[...e[34]||(e[34]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading dashboard...",-1)])])):v("",!0),a.error?(i(),o("div",Rt,[e[35]||(e[35]=c('<div class="error-icon" data-v-c056e928><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-c056e928><circle cx="12" cy="12" r="10" data-v-c056e928></circle><line x1="12" y1="8" x2="12" y2="12" data-v-c056e928></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-c056e928></line></svg></div><h3 data-v-c056e928>Something went wrong</h3>',2)),t("p",null,n(a.error),1),t("button",{onClick:e[0]||(e[0]=(...l)=>s.retryFetch&&s.retryFetch(...l)),class:"btn-primary"},"Retry")])):v("",!0)])}const Gt=x(N,[["render",qt],["__scopeId","data-v-c056e928"]]);export{Gt as default};
