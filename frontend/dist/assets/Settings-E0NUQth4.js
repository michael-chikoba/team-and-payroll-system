import{_ as h,u as S}from"./index-BxkOZnhC.js";import{b as r,p as t,q as f,t as y,C,x as o,y as a,A as b,F as _,D as x,g as v,f as d}from"./vendor-CFHPe_rb.js";const k={name:"AdminSettings",setup(){return{authStore:S()}},data(){return{settings:{company_name:"",company_address:"",tax_id:"",currency:"ZMW",annual_leave_days:21,sick_leave_days:7,maternity_leave_days:90,paternity_leave_days:14,default_password:"Password123!",max_login_attempts:5,session_timeout:60,departments:[]},originalSettings:null,loading:!1,error:null,submitting:!1,successMessage:null,retryCount:0}},computed:{hasChanges(){return this.originalSettings?JSON.stringify(this.settings)!==JSON.stringify(this.originalSettings):!1}},mounted(){this.initializeComponent()},methods:{initializeComponent(){if(!this.authStore.isAuthenticated){this.error="Please log in to access admin settings.";return}if(!this.authStore.isAdmin){this.error="You do not have permission to access this page.";return}this.fetchSettings()},async fetchSettings(l=!1){this.loading=!0,this.error=null;try{const e=await v.get("/api/admin/settings");this.settings={...this.settings,...e.data},this.originalSettings=JSON.parse(JSON.stringify(this.settings))}catch(e){this.handleApiError(e)}finally{this.loading=!1}},retryFetch(){this.retryCount++,this.retryCount<=3?this.fetchSettings(!0):this.error="Max retries exceeded. Check your network or server."},async saveSettings(){this.submitting=!0,this.error=null,this.successMessage=null;try{await v.put("/api/admin/settings",this.settings),this.successMessage="Settings updated successfully! Changes will reflect across the system.",this.originalSettings=JSON.parse(JSON.stringify(this.settings)),this.$notify&&this.$notify({type:"success",title:"Success",text:"Admin settings updated successfully!"})}catch(l){this.handleApiError(l)}finally{this.submitting=!1}},addDepartment(){this.settings.departments.push({name:""})},removeDepartment(l){this.settings.departments.length>1&&this.settings.departments.splice(l,1)},onSettingChange(){},handleApiError(l){var m,g,i,n,s;let e="An unexpected error occurred.";l.code==="ERR_NETWORK"||l.message.includes("Network Error")?e="Network error: Unable to connect to server.":((m=l.response)==null?void 0:m.status)===401?(e="Your session has expired. Please log in again.",this.authStore.clearAuth(),this.$router.push({name:"login"})):((g=l.response)==null?void 0:g.status)===403?e="You do not have permission to perform this action.":((i=l.response)==null?void 0:i.status)===422?e="Validation error: "+Object.values(l.response.data.errors||{}).flat().join(", "):e=((s=(n=l.response)==null?void 0:n.data)==null?void 0:s.message)||e,this.error=e}}},D={class:"admin-settings"},U={class:"page-header"},A=["disabled"],V={key:0},w={key:1},I={key:0,class:"error-message"},M={key:1,class:"error-message"},N={key:2,class:"loading"},E={key:3,class:"error-message"},c={key:4,class:"settings-content"},L={class:"settings-section"},O={class:"settings-grid"},P={class:"setting-field"},R={class:"setting-field"},J={class:"setting-field"},F={class:"setting-field"},T={class:"settings-section"},W={class:"settings-grid"},Y={class:"setting-field"},B={class:"setting-field"},Z={class:"setting-field"},j={class:"setting-field"},q={class:"settings-section"},z={class:"settings-grid"},K={class:"setting-field"},G={class:"setting-field"},H={class:"setting-field"},Q={class:"settings-section"},X={class:"departments-list"},$=["onUpdate:modelValue"],ee=["onClick","disabled"],te={key:0,class:"success-message"};function se(l,e,m,g,i,n){return d(),r("div",D,[t("div",U,[e[26]||(e[26]=t("h1",null,"Admin Settings",-1)),t("button",{onClick:e[0]||(e[0]=(...s)=>n.saveSettings&&n.saveSettings(...s)),class:"btn-primary",disabled:i.submitting||!n.hasChanges},[i.submitting?(d(),r("span",V,"ðŸ’¾ Saving...")):(d(),r("span",w,"ðŸ’¾ Save Changes"))],8,A)]),g.authStore.isAuthenticated?g.authStore.isAdmin?i.loading?(d(),r("div",N,[...e[27]||(e[27]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading settings...",-1)])])):i.error?(d(),r("div",E,[f(y(i.error)+" ",1),t("button",{onClick:e[1]||(e[1]=(...s)=>n.retryFetch&&n.retryFetch(...s)),class:"btn-primary",style:{"margin-top":"1rem"}},"Retry")])):(d(),r("div",c,[t("div",L,[e[33]||(e[33]=t("h2",null,"Company Information",-1)),t("div",O,[t("div",P,[e[28]||(e[28]=t("label",null,"Company Name *",-1)),o(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.settings.company_name=s),type:"text",placeholder:"Enter company name",required:"",onInput:e[3]||(e[3]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.company_name]])]),t("div",R,[e[29]||(e[29]=t("label",null,"Company Address",-1)),o(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>i.settings.company_address=s),rows:"3",placeholder:"Enter company address",onInput:e[5]||(e[5]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.company_address]])]),t("div",J,[e[30]||(e[30]=t("label",null,"Tax ID",-1)),o(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>i.settings.tax_id=s),type:"text",placeholder:"Enter tax ID",onInput:e[7]||(e[7]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.tax_id]])]),t("div",F,[e[32]||(e[32]=t("label",null,"Currency",-1)),o(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>i.settings.currency=s),onChange:e[9]||(e[9]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},[...e[31]||(e[31]=[t("option",{value:"USD"},"USD",-1),t("option",{value:"ZMW"},"ZMW",-1),t("option",{value:"EUR"},"EUR",-1)])],544),[[b,i.settings.currency]])])])]),t("div",T,[e[38]||(e[38]=t("h2",null,"Leave Policies",-1)),t("div",W,[t("div",Y,[e[34]||(e[34]=t("label",null,"Annual Leave Days",-1)),o(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>i.settings.annual_leave_days=s),type:"number",min:"0",placeholder:"e.g., 21",onInput:e[11]||(e[11]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.annual_leave_days,void 0,{number:!0}]])]),t("div",B,[e[35]||(e[35]=t("label",null,"Sick Leave Days",-1)),o(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>i.settings.sick_leave_days=s),type:"number",min:"0",placeholder:"e.g., 7",onInput:e[13]||(e[13]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.sick_leave_days,void 0,{number:!0}]])]),t("div",Z,[e[36]||(e[36]=t("label",null,"Maternity Leave Days",-1)),o(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>i.settings.maternity_leave_days=s),type:"number",min:"0",placeholder:"e.g., 90",onInput:e[15]||(e[15]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.maternity_leave_days,void 0,{number:!0}]])]),t("div",j,[e[37]||(e[37]=t("label",null,"Paternity Leave Days",-1)),o(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>i.settings.paternity_leave_days=s),type:"number",min:"0",placeholder:"e.g., 14",onInput:e[17]||(e[17]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.paternity_leave_days,void 0,{number:!0}]])])])]),t("div",q,[e[43]||(e[43]=t("h2",null,"System Settings",-1)),t("div",z,[t("div",K,[e[39]||(e[39]=t("label",null,"Default Password",-1)),o(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>i.settings.default_password=s),type:"text",placeholder:"e.g., Password123!",onInput:e[19]||(e[19]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.default_password]]),e[40]||(e[40]=t("small",null,"Used for new employee accounts",-1))]),t("div",G,[e[41]||(e[41]=t("label",null,"Max Login Attempts",-1)),o(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>i.settings.max_login_attempts=s),type:"number",min:"1",max:"10",placeholder:"e.g., 5",onInput:e[21]||(e[21]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.max_login_attempts,void 0,{number:!0}]])]),t("div",H,[e[42]||(e[42]=t("label",null,"Session Timeout (minutes)",-1)),o(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>i.settings.session_timeout=s),type:"number",min:"1",max:"480",placeholder:"e.g., 60",onInput:e[23]||(e[23]=(...s)=>n.onSettingChange&&n.onSettingChange(...s))},null,544),[[a,i.settings.session_timeout,void 0,{number:!0}]])])])]),t("div",Q,[e[44]||(e[44]=t("h2",null,"Departments",-1)),t("div",X,[(d(!0),r(_,null,x(i.settings.departments,(s,p)=>(d(),r("div",{key:p,class:"department-item"},[o(t("input",{"onUpdate:modelValue":u=>s.name=u,type:"text",placeholder:"Department name",onInput:e[24]||(e[24]=(...u)=>n.onSettingChange&&n.onSettingChange(...u))},null,40,$),[[a,s.name]]),t("button",{onClick:u=>n.removeDepartment(p),class:"btn-delete",disabled:i.settings.departments.length<=1}," Remove ",8,ee)]))),128)),t("button",{onClick:e[25]||(e[25]=(...s)=>n.addDepartment&&n.addDepartment(...s)),class:"btn-add-dept"},"+ Add Department")])]),i.successMessage?(d(),r("div",te,y(i.successMessage),1)):C("",!0)])):(d(),r("div",M," You don't have permission to access this page. ")):(d(),r("div",I," Please log in to access admin settings. "))])}const le=h(k,[["render",se],["__scopeId","data-v-1cda2ccb"]]);export{le as default};
